(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1512:function(e,t,n){"use strict";n.r(t);var o=n(3),r=(n(28),n(21),n(96),n(46),n(136),n(111),n(121),n(214)),c=n.n(r),l=n(373),d=n(1363),f=function(e){return new Promise((function(t,n){d.verify(e,"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz2hDn/X0Mzj3pVcxQpK3\nK7foMQYwUUCAAUYDhopl2a5kXXtaxfarRRO9z4qcCDZPZc3H4KtzFHp5OA5TU1v6\njRF9t8HKuErIvEZsrabobGTup9MlQ1un5gtMtwBuxz1UiylFx4EYJ/6bAtTU714E\nIpvg2dQ8EHPaXna4CKkO8m2+0sfoQVfh/uWJ9lUUmINB1587CZAwsN7JAxEDI7gR\nfrJI/5/ANcOnR31QxhbSrR1emkSYVMBVvB85OzYQEecmKI+T5kpxmxHH/bBofFlV\n4Vg62OWmWfZqJi+kEYAgRoEdosFTRw9l4eOqDhCIY8grU27hXw/t1Vmb10w6XeWN\nfQIDAQAB\n-----END PUBLIC KEY-----",{algorithms:["RS256"]},(function(e,o){return e?n(e):t(o)}))}))},h={name:"Migrate",middleware:["auth"],components:{SuccessModal:l.a},data:function(){return{user:null,ssoToken:this.$route.query.ssoToken,loading:!1,migrationNeeded:!0,successMessage:"",successTitle:""}},created:function(){this.ssoToken&&this.getToken(this.ssoToken),this.checkMigrationNeeded()},methods:{login:function(){var e=window.location.origin+"/migrate";window.location="".concat("https://auth.acc.effect.ai","?redirect=").concat(e)},migrate:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!confirm("Are you sure you want to migrate over your qualifications from this account?")){n.next=13;break}return n.prev=1,t.loading=!0,n.next=5,c.a.post("".concat("https://worker.acc.effect.ai","/user/migrate-qualifications"),t.$auth.user.vAccountRows[0].id,{headers:{Authorization:"Bearer "+e}});case 5:t.successTitle="Migration complete!",t.successMessage="Congratulations! You have successfully migrated your earned qualifications to the new Effect Network. Check your profile page to see your limited edition qualification.",n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),t.$blockchain.handleError(n.t0);case 12:t.loading=!1;case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))()},checkMigrationNeeded:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,n=117,t.next=4,e.$blockchain.getAssignedQualifications(e.$auth.user.vAccountRows[0].id);case 4:o=t.sent,r=o.some((function(q){return n===q.id})),e.migrationNeeded=!r,e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},getToken:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("".concat("https://auth.acc.effect.ai","/verify"),e),n.next=4,c.a.post("".concat("https://auth.acc.effect.ai","/verify"),{ssoToken:e},{headers:{Auth:"NO-AUTH"}});case 4:return l=n.sent,o=l.data.token,n.next=8,f(o);case 8:(r=n.sent).token=o,t.user=r,console.log("logged in",r),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),console.error(n.t0);case 17:return t.ssoToken=null,delete(d=Object.assign({},t.$route.query)).ssoToken,t.$router.replace({query:d}),n.abrupt("return",r);case 22:case"end":return n.stop()}}),n,null,[[0,14]])})))()},globalLogout:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o={withCredentials:!0,crossDomain:!0},e&&(o.headers={Authorization:"Bearer "+e}),n.next=5,c.a.get("".concat("https://auth.acc.effect.ai","/logout"),o);case 5:return t.user=null,n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(0),console.error(n.t0),n.abrupt("return",!1);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})))()},isAdmin:function(e){return!!e&&(e.roles.includes("admin")||e.app.roles.includes("admin"))}}},v=n(23),component=Object(v.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[e._v("\n      Qualification migration\n    ")]),e._v(" "),n("h2",{staticClass:"subtitle"},[e._v("\n      Migrate your qualifications from the old Force to the new Force\n    ")]),e._v(" "),e._m(0),e._v(" "),n("br"),e._v(" "),n("p",[e._v("By connecting your old effect force account, you can migrate over your old qualification to this new Force account.")]),e._v(" "),n("hr"),e._v(" "),e.migrationNeeded||e.succesMessage?n("div",[e.user?n("div",{staticClass:"container"},[e._m(1),e._v(" "),n("div",{staticClass:"level"},[n("div",{staticClass:"level-item"},[n("div",{},[n("p",[e._v("Old Effect Force Account:")]),e._v(" "),n("hr"),e._v(" "),n("h2",{staticClass:"title is-4"},[e._v("\n                "+e._s(e.user.email)+"\n              ")]),e._v(" "),n("br"),e._v(" "),n("h4",{staticClass:"subtitle is-5"},[e._v("\n                "+e._s(e.user.name)+"\n              ")])])]),e._v(" "),n("div",{staticClass:"level-item",staticStyle:{"max-width":"10px"}},[n("font-awesome-icon",{staticClass:"fa-2xl",attrs:{icon:"fa-solid fa-arrow-right-long"}})],1),e._v(" "),n("div",{staticClass:"level-item"},[n("div",[n("p",[e._v("New Effect Force Account:")]),e._v(" "),n("hr"),e._v(" "),n("h2",{staticClass:"title is-4"},[e._v("\n                "+e._s(e.$auth.user.accountName.slice(0,5))+"..."+e._s(e.$auth.user.accountName.slice(e.$auth.user.accountName.length-5,e.$auth.user.accountName.length))+"@"+e._s(e.$auth.user.blockchain)+"\n              ")]),e._v(" "),n("br"),e._v(" "),n("h4",{staticClass:"subtitle is-5"},[e._v("\n                vAccountID: "),n("strong",[e._v(e._s(e.$auth.user.vAccountRows[0].id))])])])])]),e._v(" "),n("div",{staticClass:"container"},[n("div",{staticClass:"buttons is-centered"},[n("button",{staticClass:"button has-text-danger",attrs:{disabled:e.loading},on:{click:function(t){return t.preventDefault(),e.globalLogout(e.user.token)}}},[e._v("\n              Switch old account\n            ")]),e._v(" "),n("button",{staticClass:"button is-primary",class:{"is-loading":e.loading},attrs:{disabled:e.loading},on:{click:function(t){return e.migrate(e.user.token)}}},[e._v("\n              Migrate\n            ")])])])]):e.ssoToken?n("h3",[e._v("\n        Logging in..\n      ")]):n("h3",[n("button",{staticClass:"button is-primary",on:{click:e.login}},[e._v("\n          Connect to old Force account\n        ")])])]):n("div",[n("h1",{staticClass:"title is-5"},[e._v("\n        You have already migrated an old account to this account.\n      ")])])]),e._v(" "),e.successMessage?n("success-modal",{attrs:{message:e.successMessage,title:e.successTitle}}):e._e()],1)}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n      With great pleasure we would like to announce that it will finally be possible for you to migrate your old qualifications to the new Effect Force.\n      This means that we will soon be sunsetting the old Effect Force on the "),n("strong",[e._v("1st of September")]),e._v(".\n      In order to keep your old qualifications please migrate them before this date.\n      You will not be able to migrate your old qualifications after this date anymore.\n      Ofcourse you will be able to earn them again by doing a qualifier.\n    ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"notification is-warning"},[n("b",[e._v("ATTENTION!")]),e._v(" You can only migrate your old qualifications "),n("strong",[e._v("ONCE")]),e._v(", so make sure to do it with your correct account.\n        ")])}],!1,null,null,null);t.default=component.exports}}]);