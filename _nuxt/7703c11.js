(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1256:function(t,e,n){"use strict";var r=n(17),c=n(6),o=n(12),l=n(90),d=n(604),m=n(603),h=n(14),f=c.RangeError,v=c.String,_=Math.floor,w=o(m),k=o("".slice),x=o(1..toFixed),C=function(t,e,n){return 0===e?n:e%2==1?C(t,e-1,n*t):C(t*t,e/2,n)},y=function(data,t,e){for(var n=-1,r=e;++n<6;)r+=t*data[n],data[n]=r%1e7,r=_(r/1e7)},T=function(data,t){for(var e=6,n=0;--e>=0;)n+=data[e],data[e]=_(n/t),n=n%t*1e7},I=function(data){for(var t=6,s="";--t>=0;)if(""!==s||0===t||0!==data[t]){var e=v(data[t]);s=""===s?e:s+w("0",7-e.length)+e}return s};r({target:"Number",proto:!0,forced:h((function(){return"0.000"!==x(8e-5,3)||"1"!==x(.9,0)||"1.25"!==x(1.255,2)||"1000000000000000128"!==x(0xde0b6b3a7640080,0)}))||!h((function(){x({})}))},{toFixed:function(t){var e,n,r,c,o=d(this),m=l(t),data=[0,0,0,0,0,0],h="",_="0";if(m<0||m>20)throw f("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return v(o);if(o<0&&(h="-",o=-o),o>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(o*C(2,69,1))-69)<0?o*C(2,-e,1):o/C(2,e,1),n*=4503599627370496,(e=52-e)>0){for(y(data,0,n),r=m;r>=7;)y(data,1e7,0),r-=7;for(y(data,C(10,r,1),0),r=e-1;r>=23;)T(data,1<<23),r-=23;T(data,1<<r),y(data,1,1),T(data,2),_=I(data)}else y(data,0,n),y(data,1<<-e,0),_=I(data)+w("0",m);return _=m>0?h+((c=_.length)<=m?"0."+w("0",m-c)+_:k(_,0,c-m)+"."+k(_,c-m)):h+_}})},1344:function(t,e,n){var content=n(1473);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(58).default)("74330682",content,!0,{sourceMap:!1})},1471:function(t,e,n){t.exports=n.p+"img/instruction-icon.f0fc0a2.svg"},1472:function(t,e,n){"use strict";n(1344)},1473:function(t,e,n){var r=n(57)(!1);r.push([t.i,"@import url(https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap);"]),r.push([t.i,".wrapper[data-v-99ec9a58]{min-height:calc(100vh - 110px);display:flex;flex-direction:column}.wrapper section.template-section[data-v-99ec9a58]{flex:1}",""]),t.exports=r},1480:function(t,e,n){"use strict";n.r(e);var r=[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"icon"},[e("img",{attrs:{src:n(1471)}})])}],c=(n(88),n(50),n(79),n(107),n(59),n(108),n(3)),o=n(38),l=(n(33),n(185),n(25),n(183)),d=n(95),m=n(1258),h=n(1300),f=n(1277),v={name:"SubmittedTaskModal",props:{campaign:{type:Object,required:!0,default:function(){return{}}},show:{type:Boolean,required:!1,default:!1}},data:function(){return{}},computed:{showModal:{get:function(){return this.show},set:function(t){this.$emit("clicked",t)}}},methods:{onCancel:function(){this.showModal=!1,this.$router.push("/campaigns/"+this.campaign.id)},onClick:function(){this.$parent.reserveTask()}}},_=n(23),w=Object(_.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.campaign?n("div",{staticClass:"modal",class:{"is-active":t.showModal}},[n("div",{staticClass:"modal-background"}),t._v(" "),n("div",{staticClass:"modal-card"},[t._m(0),t._v(" "),n("section",{staticClass:"modal-card-body"},[t._v("\n      Congratulations! You've earned "),n("b",[t._v(t._s(t.campaign.reward.quantity))]),t._v(" by submitting this task!"),n("br"),t._v("\n      Keep earning EFX by completing more tasks.\n    ")]),t._v(" "),n("footer",{staticClass:"modal-card-foot is-justify-content-space-between"},[n("button",{staticClass:"button",on:{click:function(e){return e.preventDefault(),t.onCancel()}}},[t._v("\n        Cancel\n      ")]),t._v(" "),n("button",{staticClass:"button is-primary is-pulled-right",on:{click:function(e){return e.preventDefault(),t.onClick()}}},[t._v("\n        Next Task ->\n      ")])])])]):t._e()}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v("\n        Task Submitted\n      ")])])}],!1,null,"4777a78e",null).exports;function k(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var x={components:{TemplateMedia:m.a,ReserveTask:h.a,InstructionsModal:f.a,SubmittedTaskModal:w},middleware:["auth"],data:function(){return{campaignId:parseInt(this.$route.params.id),batchId:parseInt(this.$route.params.batch),taskIndex:parseInt(this.$route.params.task),submissionId:parseInt(this.$route.query.submissionId),campaign:void 0,batch:void 0,task:void 0,reserveNextTask:!1,loading:!1,showInstructionsModal:!1,showSubmittedTaskModal:!1,reserveInBatch:null}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(l.c)({batches:function(t){return t.campaign.batches},campaigns:function(t){return t.campaign.campaigns},campaignLoading:function(t){return t.campaign.loading},batchLoading:function(t){return t.campaign.loadingBatch}})),created:function(){this.getBatch(),this.getCampaign()},methods:{showInstructions:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.showInstructionsModal=t},renderTemplate:function(template){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new d.Template(template,t,e).render()},getBatch:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("campaign/getBatch",{batchId:t.batchId});case 2:t.batch=t.batches.find((function(b){return b.batch_id===t.batchId})),t.task=t.batch.tasks[t.taskIndex];case 4:case"end":return e.stop()}}),e)})))()},getCampaign:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("campaign/getCampaign",t.campaignId);case 2:t.campaign=t.campaigns.find((function(e){return e.id===t.campaignId}));case 3:case"end":return e.stop()}}),e)})))()},releaseTask:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$blockchain.releaseTask(t);case 3:data=n.sent,e.$store.dispatch("transaction/addTransaction",data),e.$router.push("/campaigns/"+e.batch.campaign_id+"/"+e.batch.batch_id),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},reserveTask:function(){try{this.showSubmittedTaskModal=!1,this.reserveNextTask=!0}catch(t){throw this.loading=!1,new Error(t)}},submitTask:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e.loading=!0,e.reserveNextTask=!1,n.next=5,e.$blockchain.submitTask(e.batch.batch_id,e.submissionId,JSON.stringify(t));case 5:return r=n.sent,n.next=8,e.$blockchain.waitForTransaction(r);case 8:e.$store.dispatch("transaction/addTransaction",r),e.loading=!1,e.showSubmittedTaskModal=!0,n.next=16;break;case 13:throw n.prev=13,n.t0=n.catch(0),new Error(n.t0);case 16:case"end":return n.stop()}}),n,null,[[0,13]])})))()}}},C=x,y=(n(1472),Object(_.a)(C,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrapper"},[t.campaign&&t.campaign.info?r("instructions-modal",{attrs:{readonly:!0,campaign:t.campaign,info:t.campaign.info,show:t.showInstructionsModal},on:{clicked:t.showInstructions}}):t._e(),t._v(" "),t.campaign&&t.campaign.reward?r("submitted-task-modal",{attrs:{campaign:t.campaign,show:t.showSubmittedTaskModal}}):t._e(),t._v(" "),r("section",{staticClass:"section has-background-secondary py-1 has-text-white"},[r("div",{staticClass:"container"},[r("div",{staticClass:"columns is-vcentered"},[r("div",{staticClass:"column is-narrow is-flex is-align-items-center is-justify-content-space-between"},[r("button",{staticClass:"button is-secondary",on:{click:function(e){return e.preventDefault(),t.showInstructions.apply(null,arguments)}}},[t._m(0),t._v(" "),r("span",[t._v("Instructions")])]),t._v(" "),r("span",{staticClass:"is-hidden-desktop"},[t._v("\n            Reward:\n            "),t.campaign?r("b",[t._v(t._s(t.campaign.reward.quantity))]):r("b",[t._v("...... EFX")])])]),t._v(" "),r("div",{staticClass:"column has-text-centered"},[t.campaign&&t.campaign.info?r("b",[t._v(t._s(t.campaign.info.title))]):r("b",[t._v("......")]),t._v(" "),r("span",{staticClass:"px-2 is-hidden-touch"},[t._v(" | ")]),t._v(" "),r("span",[r("span",{staticClass:"is-hidden-touch"},[t._v("Task ")]),r("b",[t._v("#"+t._s(t.taskIndex))])])]),t._v(" "),r("div",{staticClass:"column is-narrow is-hidden-touch"},[t._v("\n          Reward:\n          "),t.campaign?r("b",[t._v(t._s(t.campaign.reward.quantity))]):r("b",[t._v("...... EFX")])])])])]),t._v(" "),r("section",{staticClass:"section template-section"},[r("div",{staticClass:"container"},[t.loading?r("div",{staticClass:"loader-wrapper is-active"},[r("img",{attrs:{src:n(374)}}),t._v(" "),r("br"),r("span",{staticClass:"loading-text"},[t._v("Waiting for the transaction to complete")])]):t._e(),t._v(" "),t.campaign&&t.campaign.info&&t.task?r("template-media",{attrs:{html:t.renderTemplate(t.campaign.info.template||"No template found..",t.task)},on:{submit:t.submitTask}}):r("div",{staticClass:"loading-text"},[t._v("\n        Loading\n      ")]),t._v(" "),t.reserveNextTask?r("reserve-task",{attrs:{batch:t.batch}}):t._e()],1)]),t._v(" "),r("section",{staticClass:"py-3 has-background-light"},[r("div",{staticClass:"container has-text-centered"},[r("button",{staticClass:"button is-danger is-small",on:{click:function(e){return e.preventDefault(),t.releaseTask(t.submissionId)}}},[t._v("\n        Stop Task\n      ")])])])],1)}),r,!1,null,"99ec9a58",null));e.default=y.exports}}]);