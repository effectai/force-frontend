(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1512:function(t,e,n){"use strict";n.r(e);var r=n(3),o=(n(31),n(23),n(96),n(46),n(136),n(111),n(121),n(214)),c=n.n(o),l=n(1363),f=function(t){return new Promise((function(e,n){l.verify(t,"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz2hDn/X0Mzj3pVcxQpK3\nK7foMQYwUUCAAUYDhopl2a5kXXtaxfarRRO9z4qcCDZPZc3H4KtzFHp5OA5TU1v6\njRF9t8HKuErIvEZsrabobGTup9MlQ1un5gtMtwBuxz1UiylFx4EYJ/6bAtTU714E\nIpvg2dQ8EHPaXna4CKkO8m2+0sfoQVfh/uWJ9lUUmINB1587CZAwsN7JAxEDI7gR\nfrJI/5/ANcOnR31QxhbSrR1emkSYVMBVvB85OzYQEecmKI+T5kpxmxHH/bBofFlV\n4Vg62OWmWfZqJi+kEYAgRoEdosFTRw9l4eOqDhCIY8grU27hXw/t1Vmb10w6XeWN\nfQIDAQAB\n-----END PUBLIC KEY-----",{algorithms:["RS256"]},(function(t,r){return t?n(t):e(r)}))}))},h={name:"Migrate",middleware:["auth"],data:function(){return{user:null,ssoToken:this.$route.query.ssoToken,loading:!1}},created:function(){this.ssoToken&&this.getToken(this.ssoToken)},methods:{login:function(){var t=window.location.origin+"/migrate";window.location="".concat("https://auth.acc.effect.ai","?redirect=").concat(t)},migrate:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e.loading=!0,n.next=4,c.a.post("".concat("https://worker.acc.effect.ai","/user/migrate-qualifications"),e.$auth.user.vAccountRows[0].id,{headers:{Authorization:"Bearer "+t}});case 4:e.$router.push("/profile"),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),e.$blockchain.handleError(n.t0);case 10:e.loading=!1;case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},getToken:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("".concat("https://auth.acc.effect.ai","/verify"),t),n.next=4,c.a.post("".concat("https://auth.acc.effect.ai","/verify"),{ssoToken:t},{headers:{Auth:"NO-AUTH"}});case 4:return l=n.sent,r=l.data.token,n.next=8,f(r);case 8:(o=n.sent).token=r,e.user=o,console.log("logged in",o),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),console.error(n.t0);case 17:return e.ssoToken=null,delete(h=Object.assign({},e.$route.query)).ssoToken,e.$router.replace({query:h}),n.abrupt("return",o);case 22:case"end":return n.stop()}}),n,null,[[0,14]])})))()},globalLogout:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r={withCredentials:!0,crossDomain:!0},t&&(r.headers={Authorization:"Bearer "+t}),n.next=5,c.a.get("".concat("https://auth.acc.effect.ai","/logout"),r);case 5:return e.user=null,n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(0),console.error(n.t0),n.abrupt("return",!1);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})))()},isAdmin:function(t){return!!t&&(t.roles.includes("admin")||t.app.roles.includes("admin"))}}},v=n(22),component=Object(v.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[t._v("\n      Migrate your Qualifications\n    ")]),t._v(" "),n("h2",{staticClass:"subtitle"},[t._v("\n      Migrate your qualifications from the old Force to the new Force\n    ")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t.user?n("div",[n("p",[t._v("Old Effect Force Account:")]),t._v(" "),n("h2",{staticClass:"title is-4"},[t._v("\n        "+t._s(t.user.name)+"\n      ")]),t._v(" "),n("h4",{staticClass:"subtitle is-5"},[t._v("\n        "+t._s(t.user.email)+"\n      ")]),t._v(" "),n("div",[n("p"),n("b",[t._v("Are you sure you want to migrate over your qualifications from this account?")]),n("p"),t._v(" "),n("button",{staticClass:"button is-primary",class:{"is-loading":t.loading},attrs:{disabled:t.loading},on:{click:function(e){return t.migrate(t.user.token)}}},[t._v("\n          Migrate\n        ")])]),t._v(" "),n("div",{staticClass:"mt-4"},[n("a",{staticClass:" has-text-danger",on:{click:function(e){return e.preventDefault(),t.globalLogout(t.user.token)}}},[t._v("\n          switch account\n        ")])])]):t.ssoToken?n("h3",[t._v("\n      Logging in..\n    ")]):n("h3",[n("button",{staticClass:"button is-primary",on:{click:t.login}},[t._v("\n        Connect to old Force account\n      ")])])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("By connecting your old effect force account,"),n("br"),t._v("you can migrate over your old qualification to this new Force account.")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"notification is-warning"},[n("b",[t._v("ATTENTION!")]),t._v(" You can only migrate your old qualifications once, so make sure to do it to your correct account.\n    ")])}],!1,null,null,null);e.default=component.exports}}]);