(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1255:function(t,e,n){var content=n(1259);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(58).default)("2ac9a1b4",content,!0,{sourceMap:!1})},1257:function(t,e,n){"use strict";var r=n(17),o=n(6),c=n(12),l=n(90),d=n(604),h=n(603),m=n(14),f=o.RangeError,v=o.String,k=Math.floor,_=c(h),w=c("".slice),x=c(1..toFixed),y=function(t,e,n){return 0===e?n:e%2==1?y(t,e-1,n*t):y(t*t,e/2,n)},C=function(data,t,e){for(var n=-1,r=e;++n<6;)r+=t*data[n],data[n]=r%1e7,r=k(r/1e7)},I=function(data,t){for(var e=6,n=0;--e>=0;)n+=data[e],data[e]=k(n/t),n=n%t*1e7},$=function(data){for(var t=6,s="";--t>=0;)if(""!==s||0===t||0!==data[t]){var e=v(data[t]);s=""===s?e:s+_("0",7-e.length)+e}return s};r({target:"Number",proto:!0,forced:m((function(){return"0.000"!==x(8e-5,3)||"1"!==x(.9,0)||"1.25"!==x(1.255,2)||"1000000000000000128"!==x(0xde0b6b3a7640080,0)}))||!m((function(){x({})}))},{toFixed:function(t){var e,n,r,o,c=d(this),h=l(t),data=[0,0,0,0,0,0],m="",k="0";if(h<0||h>20)throw f("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return v(c);if(c<0&&(m="-",c=-c),c>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(c*y(2,69,1))-69)<0?c*y(2,-e,1):c/y(2,e,1),n*=4503599627370496,(e=52-e)>0){for(C(data,0,n),r=h;r>=7;)C(data,1e7,0),r-=7;for(C(data,y(10,r,1),0),r=e-1;r>=23;)I(data,1<<23),r-=23;I(data,1<<r),C(data,1,1),I(data,2),k=$(data)}else C(data,0,n),C(data,1<<-e,0),k=$(data)+_("0",h);return k=h>0?m+((o=k.length)<=h?"0."+_("0",h-o)+k:w(k,0,o-h)+"."+w(k,o-h)):m+k}})},1258:function(t,e,n){"use strict";n(1255)},1259:function(t,e,n){var r=n(57)(!1);r.push([t.i,"@import url(https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap);"]),r.push([t.i,".template-wrapper[data-v-502fba47]{width:100%}#mediaFrame[data-v-502fba47]{width:100%;border:none}",""]),t.exports=r},1261:function(t,e,n){"use strict";n(25),n(69);var r={props:{html:{type:String,default:null}},data:function(){return{alternativeFrontendUrl:"https://effectai.github.io/force-frontend-new",loading:!0}},watch:{html:function(t){document.getElementById("mediaFrame").contentWindow.postMessage({task:"template",value:t},"*")}},mounted:function(){document.addEventListener("keydown",this.sendKeyEvents)},created:function(){window.addEventListener("message",this.communicateWithIframe)},beforeDestroy:function(){window.removeEventListener("message",this.communicateWithIframe),document.removeEventListener("keydown",this.sendKeyEvents)},methods:{mediaFrameLoaded:function(){this.loading=!1,document.getElementById("mediaFrame").contentWindow.postMessage({task:"template",value:this.html},"*"),this.$emit("templateLoaded")},sendKeyEvents:function(t){var e=document.getElementById("mediaFrame");e&&e.contentWindow.postMessage({task:"key",key:t.key},"*")},communicateWithIframe:function(t){var data=t.data;switch(data.task){case"setHeight":document.getElementById("mediaFrame").height=data.height+"px";break;case"submit":this.$emit("submit",data.values);break;case"results":document.getElementById("mediaFrame").contentWindow.postMessage(data,"*")}}}},o=(n(1258),n(23)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"template-wrapper"},[t.loading?n("div",{staticClass:"loading-text subtitle"},[t._v("\n    Loading\n  ")]):t._e(),t._v(" "),n("iframe",{ref:"mediaFrame",attrs:{id:"mediaFrame",src:t.alternativeFrontendUrl+"/template",name:"mediaFrame",sandbox:"allow-scripts allow-modals allow-downloads allow-forms allow-popups allow-pointer-lock allow-same-origin",allow:"geolocation; microphone; camera; autoplay; fullscreen",allowFullScreen:""},on:{load:t.mediaFrameLoaded}})])}),[],!1,null,"502fba47",null);e.a=component.exports},1269:function(t,e,n){"use strict";var r=n(1283),o=n.n(r),c={name:"InstructionsModal",props:{campaign:{type:Object,required:!0,default:function(){return{}}},info:{type:Object,required:!0,default:function(){return{}}},show:{type:Boolean,required:!1,default:!1},functional:{type:Boolean,required:!1,default:!0},readonly:{type:Boolean,required:!1,default:!1}},data:function(){return{tac:!1}},computed:{showModal:{get:function(){return this.show},set:function(t){this.$emit("clicked",t)}}},methods:{onCancel:function(){this.functional&&(this.showModal=!1)},onClick:function(){this.functional&&this.$parent.joinCampaign()},sanitizeHtmlCustom:function(t){return o()(t,{allowedTags:["h1","h2","h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre","iframe","img","span","label"],allowedAttributes:{a:["href","name","target","class"],img:["src","alt"],iframe:["src"],"*":["style"]}})}}},l=n(23),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.campaign&&t.info?n("div",{staticClass:"modal",class:{"is-active":t.showModal},style:{position:t.functional?"fixed":"relative",padding:t.functional?"initial":"10px",zIndex:t.functional?"40":"1"}},[n("div",{staticClass:"modal-background"}),t._v(" "),n("div",{staticClass:"modal-card"},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v("\n        "+t._s(t.info.title)+"\n      ")]),t._v(" "),n("button",{staticClass:"delete",attrs:{"aria-label":"close",disabled:!t.functional},on:{click:function(e){return e.preventDefault(),t.onCancel()}}})]),t._v(" "),n("section",{staticClass:"modal-card-body"},[t.campaign&&t.info?n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.sanitizeHtmlCustom(t.$md.render(t.info.instructions)))}}):n("p",[t._v("\n        ...\n      ")]),t._v(" "),n("label",{staticClass:"checkbox"},[t.readonly?n("input",{attrs:{checked:"",type:"checkbox",disabled:""}}):n("input",{directives:[{name:"model",rawName:"v-model",value:t.tac,expression:"tac"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.tac)?t._i(t.tac,null)>-1:t.tac},on:{change:function(e){var n=t.tac,r=e.target,o=!!r.checked;if(Array.isArray(n)){var c=t._i(n,null);r.checked?c<0&&(t.tac=n.concat([null])):c>-1&&(t.tac=n.slice(0,c).concat(n.slice(c+1)))}else t.tac=o}}}),t._v("\n        I agree to the "),n("a",{attrs:{href:"/download/tac.pdf",target:"_blank"}},[t._v("terms and conditions")])])]),t._v(" "),n("footer",{staticClass:"modal-card-foot"},[t.readonly?n("button",{staticClass:"button is-primary",attrs:{disabled:!t.functional},on:{click:function(e){return e.preventDefault(),t.onCancel()}}},[t._v("\n        OK\n      ")]):[n("button",{staticClass:"button is-primary has-tooltip has-tooltip-arrow",attrs:{"data-tooltip":t.tac?"No additional\nqualifications needed":"agree to the terms and\nconditions to qualify",disabled:!(t.tac&&t.campaign&&t.info&&t.functional)},on:{click:function(e){return e.preventDefault(),t.onClick()}}},[t._v("\n          Qualify\n        ")]),t._v(" "),n("button",{staticClass:"button",attrs:{disabled:!t.functional},on:{click:function(e){return e.preventDefault(),t.onCancel()}}},[t._v("\n          Cancel\n        ")])]],2)])]):t._e()}),[],!1,null,"40d012a4",null);e.a=component.exports},1276:function(t,e){},1277:function(t,e){},1281:function(t,e){},1282:function(t,e){},1286:function(t,e){},1287:function(t,e,n){"use strict";var r=n(3);n(33),n(135),n(1257),n(79),n(25),n(89),n(71),n(92),n(70),n(51),n(50),n(91),n(93),n(69);function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,d=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return l=t.done,t},e:function(t){d=!0,o=t},f:function(){try{l||null==n.return||n.return()}finally{if(d)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var l=n(375),d={props:{batch:{type:Object,default:null}},data:function(){return{loading:!1,error:null,now:0}},mounted:function(){this.updateNow(),setInterval(this.updateNow,1e3),this.makeReservation()},methods:{updateNow:function(){this.now=parseInt((Date.now()/1e3).toFixed(0))},makeReservation:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,c,d,h,m,f,v,sub,k,_,w,x,y,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.$blockchain.getSubmissionsAndReservationsForBatch(t.batch.batch_id);case 4:return n=e.sent,c=n.filter((function(t){return!t.data||!t.data.length})),d=n.filter((function(s){return s.data||s.data.length})),e.next=9,t.getReservationForUser(c);case 9:if(null!==(h=e.sent).reservation||!1!==h.isReleased){e.next=41;break}m=t.batch.tasks_done,f=o(d),e.prev=13,f.s();case 15:if((v=f.n()).done){e.next=26;break}if(sub=v.value,k=[],sub.account_id!==t.$auth.user.vAccountRows[0].id){e.next=23;break}return e.next=21,t.$blockchain.getTaskIndexFromLeaf(t.batch.campaign_id,t.batch.id,sub.leaf_hash,t.batch.tasks);case 21:_=e.sent,k.push(_);case 23:k.length>0&&Math.max(k)>=t.batch.tasks_done&&(m=Math.max(k)+1);case 24:e.next=15;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(13),f.e(e.t0);case 31:return e.prev=31,f.f(),e.finish(31);case 34:return m>t.batch.num_tasks&&t.$router.push("/campaigns/"+t.batch.campaign_id+"/"+t.batch.batch_id+"?batchCompleted=1"),e.next=37,t.$blockchain.reserveTask(t.batch.id,m,t.batch.campaign_id,t.batch.tasks);case 37:return w=e.sent,t.$store.dispatch("transaction/addTransaction",w),e.next=41,l(Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$blockchain.getTaskReservationsForBatch(t.batch.batch_id);case 2:return n=e.sent,e.next=5,t.getReservationForUser(n);case 5:if((h=e.sent).reservation){e.next=8;break}throw new Error("Reservation not found");case 8:case"end":return e.stop()}}),e)}))),{retries:5,onRetry:function(t,e){console.log("attempt",e,t)}});case 41:if(!h.reservation||!1!==h.isReleased||!0!==h.isExpired){e.next=48;break}return e.next=44,t.$blockchain.claimExpiredTask(h.reservation.id);case 44:return x=e.sent,t.$store.dispatch("transaction/addTransaction",x),e.next=48,l(Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$blockchain.getTaskReservationsForBatch(t.batch.batch_id);case 2:return n=e.sent,e.next=5,t.getReservationForUser(n);case 5:if((h=e.sent).reservation){e.next=8;break}throw new Error("Reservation not found");case 8:case"end":return e.stop()}}),e)}))),{retries:5,onRetry:function(t,e){console.log("attempt",e,t)}});case 48:if(!h.reservation||!0!==h.isReleased||!1!==h.isExpired){e.next=55;break}return e.next=51,t.$blockchain.reclaimTask(h.reservation.id);case 51:return y=e.sent,t.$store.dispatch("transaction/addTransaction",y),e.next=55,l(Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$blockchain.getTaskReservationsForBatch(t.batch.batch_id);case 2:return n=e.sent,e.next=5,t.getReservationForUser(n);case 5:if((h=e.sent).reservation){e.next=8;break}throw new Error("Reservation not found");case 8:case"end":return e.stop()}}),e)}))),{retries:5,onRetry:function(t,e){console.log("attempt",e,t)}});case 55:if(!h.reservation||!1!==h.isExpired||!1!==h.isReleased){e.next=62;break}return e.next=58,t.$blockchain.getTaskIndexFromLeaf(t.batch.campaign_id,t.batch.id,h.reservation.leaf_hash,t.batch.tasks);case 58:C=e.sent,t.$router.push("/campaigns/"+t.batch.campaign_id+"/"+t.batch.batch_id+"/"+C+"?submissionId="+h.reservation.id),e.next=63;break;case 62:t.$router.push("/campaigns/"+t.batch.campaign_id);case 63:t.loading=!1,e.next=70;break;case 66:e.prev=66,e.t1=e.catch(0),t.loading=!1,t.$blockchain.handleError(e.t1);case 70:case"end":return e.stop()}}),e,null,[[0,66],[13,28,31,34]])})))()},getReservationForUser:function(t){var e,n,r,c,l=o(t);try{for(l.s();!(c=l.n()).done;){var d=c.value;if(!(d.account_id!==this.$auth.user.vAccountRows[0].id||parseInt(this.batch.batch_id)!==parseInt(d.batch_id)||d.data&&d.data.length)){e=d,n=!1,r=!1;break}if(!(null!==d.account_id||parseInt(this.batch.batch_id)!==parseInt(d.batch_id)||d.data&&d.data.length)){e=d,n=!0,r=!1;break}!(null!==d.account_id&&parseInt(new Date(new Date(d.submitted_on)+"UTC").getTime()/1e3)+parseInt(this.$blockchain.sdk.force.config.release_task_delay_sec.toFixed(0))<this.now&&parseInt(this.batch.batch_id)===parseInt(d.batch_id))||d.data&&d.data.length?(e=null,n=!1,r=!1):(e=d,n=!1,r=!0)}}catch(t){l.e(t)}finally{l.f()}return 0===t.length&&(e=null,n=!1,r=!1),{reservation:e,isReleased:n,isExpired:r}}}},h=n(23),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",[t.loading?r("div",{staticClass:"loader-wrapper is-active"},[r("img",{attrs:{src:n(374)}}),t._v(" "),r("br"),r("span",{staticClass:"loading-text"},[t._v("Making reservation")])]):t._e()])}),[],!1,null,null,null);e.a=component.exports},1344:function(t,e,n){var content=n(1472);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(58).default)("46b90320",content,!0,{sourceMap:!1})},1470:function(t,e,n){t.exports=n.p+"img/instruction-icon.f0fc0a2.svg"},1471:function(t,e,n){"use strict";n(1344)},1472:function(t,e,n){var r=n(57)(!1);r.push([t.i,"@import url(https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap);"]),r.push([t.i,".wrapper[data-v-4b54b6c9]{min-height:calc(100vh - 110px);display:flex;flex-direction:column}.wrapper section.template-section[data-v-4b54b6c9]{flex:1}",""]),t.exports=r},1479:function(t,e,n){"use strict";n.r(e);var r=[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"icon"},[e("img",{attrs:{src:n(1470)}})])}],o=(n(88),n(50),n(79),n(106),n(59),n(107),n(3)),c=n(38),l=(n(33),n(186),n(25),n(184)),d=n(136),h=n(1261),m=n(1287),f=n(1269),v={name:"SubmittedTaskModal",props:{campaign:{type:Object,required:!0,default:function(){return{}}},show:{type:Boolean,required:!1,default:!1}},data:function(){return{}},computed:{showModal:{get:function(){return this.show},set:function(t){this.$emit("clicked",t)}}},methods:{onCancel:function(){this.showModal=!1,this.$router.push("/campaigns/"+this.campaign.id)},onClick:function(){this.$parent.reserveTask()}}},k=n(23),_=Object(k.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.campaign?n("div",{staticClass:"modal",class:{"is-active":t.showModal}},[n("div",{staticClass:"modal-background"}),t._v(" "),n("div",{staticClass:"modal-card"},[t._m(0),t._v(" "),n("section",{staticClass:"modal-card-body"},[t._v("\n      Congratulations! You've earned "),n("b",[t._v(t._s(t.campaign.reward.quantity))]),t._v(" by submitting this task!"),n("br"),t._v("\n      Keep earning EFX by completing more tasks.\n    ")]),t._v(" "),n("footer",{staticClass:"modal-card-foot is-justify-content-space-between"},[n("button",{staticClass:"button",on:{click:function(e){return e.preventDefault(),t.onCancel()}}},[t._v("\n        Cancel\n      ")]),t._v(" "),n("button",{staticClass:"button is-primary is-pulled-right",on:{click:function(e){return e.preventDefault(),t.onClick()}}},[t._v("\n        Next Task ->\n      ")])])])]):t._e()}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[t._v("\n        Task Submitted\n      ")])])}],!1,null,"4777a78e",null).exports;function w(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function x(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(e){Object(c.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var y={components:{TemplateMedia:h.a,ReserveTask:m.a,InstructionsModal:f.a,SubmittedTaskModal:_},middleware:["auth"],data:function(){return{campaignId:parseInt(this.$route.params.id),batchId:parseInt(this.$route.params.batch),taskIndex:parseInt(this.$route.params.task),submissionId:parseInt(this.$route.query.submissionId),campaign:void 0,batch:void 0,task:void 0,reserveNextTask:!1,loading:!1,showInstructionsModal:!1,showSubmittedTaskModal:!1,reserveInBatch:null}},computed:x(x(x({},Object(l.c)({batches:function(t){return t.campaign.batches},campaigns:function(t){return t.campaign.campaigns},campaignLoading:function(t){return t.campaign.loading},batchLoading:function(t){return t.campaign.loadingBatch}})),Object(l.b)({batchesByCampaignId:"campaign/batchesByCampaignId"})),{},{campaignBatches:function(){return this.batchesByCampaignId(this.campaignId)}}),created:function(){this.getBatch(),this.getCampaign()},methods:{showInstructions:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.showInstructionsModal=t},renderTemplate:function(template){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new d.Template(template,t,e).render()},getBatch:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("campaign/getBatch",{batchId:t.batchId});case 2:t.batch=t.batches.find((function(b){return b.batch_id===t.batchId})),t.task=t.batch.tasks[t.taskIndex];case 4:case"end":return e.stop()}}),e)})))()},getCampaign:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("campaign/getCampaign",t.campaignId);case 2:t.campaign=t.campaigns.find((function(e){return e.id===t.campaignId}));case 3:case"end":return e.stop()}}),e)})))()},releaseTask:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$blockchain.releaseTask(t);case 3:data=n.sent,e.$store.dispatch("transaction/addTransaction",data),e.$router.push("/campaigns/"+e.batch.campaign_id+"/"+e.batch.batch_id),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},reserveTask:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.showSubmittedTaskModal=!1,t.loading=!0,t.reserveNextTask=!0,!(t.batch.tasks_done===t.batch.num_tasks||t.taskIndex+1>=t.batch.num_tasks)){e.next=14;break}if(n=t.campaignBatches.find((function(b){return b.num_tasks-b.tasks_done>0}))){e.next=10;break}return console.error("Could not find batch with active tasks"),t.$router.push("/campaigns/"+t.batch.campaign_id),e.abrupt("return");case 10:return e.next=12,t.$store.dispatch("campaign/getBatchTasks",n);case 12:t.reserveInBatch=n,t.loading=!1;case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(0),t.loading=!1,new Error(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))()},submitTask:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e.loading=!0,e.reserveNextTask=!1,n.next=5,e.$blockchain.submitTask(e.batch.batch_id,e.submissionId,JSON.stringify(t));case 5:return r=n.sent,n.next=8,e.$blockchain.waitForTransaction(r);case 8:return e.$store.dispatch("transaction/addTransaction",r),e.loading=!1,n.next=12,e.getBatch();case 12:e.batch.tasks_done===e.batch.num_tasks||e.taskIndex+1>=e.batch.num_tasks?e.$router.push("/campaigns/"+e.batch.campaign_id+"/"+e.batch.batch_id+"?batchCompleted=1"):e.showSubmittedTaskModal=!0,n.next=18;break;case 15:throw n.prev=15,n.t0=n.catch(0),new Error(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})))()}}},C=y,I=(n(1471),Object(k.a)(C,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrapper"},[t.campaign&&t.campaign.info?r("instructions-modal",{attrs:{readonly:!0,campaign:t.campaign,info:t.campaign.info,show:t.showInstructionsModal},on:{clicked:t.showInstructions}}):t._e(),t._v(" "),t.campaign&&t.campaign.reward?r("submitted-task-modal",{attrs:{campaign:t.campaign,show:t.showSubmittedTaskModal}}):t._e(),t._v(" "),r("section",{staticClass:"section has-background-secondary py-1 has-text-white"},[r("div",{staticClass:"container"},[r("div",{staticClass:"columns is-vcentered"},[r("div",{staticClass:"column is-narrow is-flex is-align-items-center is-justify-content-space-between"},[r("button",{staticClass:"button is-secondary",on:{click:function(e){return e.preventDefault(),t.showInstructions.apply(null,arguments)}}},[t._m(0),t._v(" "),r("span",[t._v("Instructions")])]),t._v(" "),r("span",{staticClass:"is-hidden-desktop"},[t._v("\n            Reward:\n            "),t.campaign?r("b",[t._v(t._s(t.campaign.reward.quantity))]):r("b",[t._v("...... EFX")])])]),t._v(" "),r("div",{staticClass:"column has-text-centered"},[t.campaign&&t.campaign.info?r("b",[t._v(t._s(t.campaign.info.title))]):r("b",[t._v("......")]),t._v(" "),r("span",{staticClass:"px-2 is-hidden-touch"},[t._v(" | ")]),t._v(" "),r("span",[r("span",{staticClass:"is-hidden-touch"},[t._v("Task ")]),r("b",[t._v("#"+t._s(t.taskIndex))])])]),t._v(" "),r("div",{staticClass:"column is-narrow is-hidden-touch"},[t._v("\n          Reward:\n          "),t.campaign?r("b",[t._v(t._s(t.campaign.reward.quantity))]):r("b",[t._v("...... EFX")])])])])]),t._v(" "),r("section",{staticClass:"section template-section"},[r("div",{staticClass:"container"},[t.loading?r("div",{staticClass:"loader-wrapper is-active"},[r("img",{attrs:{src:n(374)}}),t._v(" "),r("br"),r("span",{staticClass:"loading-text"},[t._v("Waiting for the transaction to complete")])]):t._e(),t._v(" "),t.campaign&&t.campaign.info&&t.task?r("template-media",{attrs:{html:t.renderTemplate(t.campaign.info.template||"No template found..",t.task)},on:{submit:t.submitTask}}):r("div",{staticClass:"loading-text"},[t._v("\n        Loading\n      ")]),t._v(" "),t.reserveNextTask?r("reserve-task",{attrs:{batch:t.reserveInBatch?t.reserveInBatch:t.batch}}):t._e()],1)]),t._v(" "),r("section",{staticClass:"py-3 has-background-light"},[r("div",{staticClass:"container has-text-centered"},[r("button",{staticClass:"button is-danger is-small",on:{click:function(e){return e.preventDefault(),t.releaseTask(t.submissionId)}}},[t._v("\n        Stop Task\n      ")])])])],1)}),r,!1,null,"4b54b6c9",null));e.default=I.exports}}]);