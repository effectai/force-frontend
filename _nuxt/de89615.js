(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1580:function(t,e,n){"use strict";n.r(e);n(60),n(66),n(61),n(43),n(53),n(69),n(48),n(70);var o=n(281),r=n(3),c=n(26),l=(n(34),n(19),n(84),n(116),n(51),n(146),n(115),n(126),n(230)),f=n.n(l),d=n(71),h=n(394);function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function m(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(e){Object(c.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var w=n(1429),_=function(t){return new Promise((function(e,n){w.verify(t,"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz2hDn/X0Mzj3pVcxQpK3\nK7foMQYwUUCAAUYDhopl2a5kXXtaxfarRRO9z4qcCDZPZc3H4KtzFHp5OA5TU1v6\njRF9t8HKuErIvEZsrabobGTup9MlQ1un5gtMtwBuxz1UiylFx4EYJ/6bAtTU714E\nIpvg2dQ8EHPaXna4CKkO8m2+0sfoQVfh/uWJ9lUUmINB1587CZAwsN7JAxEDI7gR\nfrJI/5/ANcOnR31QxhbSrR1emkSYVMBVvB85OzYQEecmKI+T5kpxmxHH/bBofFlV\n4Vg62OWmWfZqJi+kEYAgRoEdosFTRw9l4eOqDhCIY8grU27hXw/t1Vmb10w6XeWN\nfQIDAQAB\n-----END PUBLIC KEY-----",{algorithms:["RS256"]},(function(t,o){return t?n(t):e(o)}))}))},k={name:"Migrate",middleware:["auth"],components:{SuccessModal:h.a},data:function(){return{user:null,ssoToken:this.$route.query.ssoToken,loading:!1,migrationNeeded:!0,successMessage:"",successTitle:""}},computed:m(m({},Object(d.d)({qualifications:function(t){return t.qualification.qualifications},allAssignedQualificationsLoaded:function(t){return t.qualification.allAssignedQualificationsLoaded},assignedQualifications:function(t){return t.qualification.assignedQualifications}})),{},{allQualifications:function(){return this.qualifications?this.qualifications:null}}),created:function(){this.ssoToken&&this.getToken(this.ssoToken),this.$auth.user&&this.checkMigrationNeeded()},methods:{login:function(){var t=window.location.origin+"/migrate";window.location="".concat("https://auth.acc.effect.ai","?redirect=").concat(t)},migrate:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!confirm("Are you sure you want to migrate over your qualifications from this account?")){n.next=13;break}return n.prev=1,e.loading=!0,n.next=5,f.a.post("".concat("https://worker.acc.effect.ai","/user/migrate-qualifications"),e.$auth.user.vAccountRows[0].id,{headers:{Authorization:"Bearer "+t}});case 5:e.successTitle="Migration complete!",e.successMessage="Congratulations! You have successfully migrated your earned qualifications to the new Effect Network platform. Check your profile page to see your limited edition qualification!",n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),e.$blockchain.handleError(n.t0);case 12:e.loading=!1;case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))()},checkMigrationNeeded:function(){var t=this;if(this.allAssignedQualificationsLoaded)try{this.loading=!0;var e=Object(o.a)(this.assignedQualifications).some((function(q){return 117===q.id}));this.migrationNeeded=!e,this.loading=!1}catch(t){this.$blockchain.handleError(t)}else setTimeout((function(){t.checkMigrationNeeded()}),1e3)},getToken:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("".concat("https://auth.acc.effect.ai","/verify"),t),n.next=4,f.a.post("".concat("https://auth.acc.effect.ai","/verify"),{ssoToken:t},{headers:{Auth:"NO-AUTH"}});case 4:return c=n.sent,o=c.data.token,n.next=8,_(o);case 8:(r=n.sent).token=o,e.user=r,console.log("logged in",r),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),console.error(n.t0);case 17:return e.ssoToken=null,delete(l=Object.assign({},e.$route.query)).ssoToken,e.$router.replace({query:l}),n.abrupt("return",r);case 22:case"end":return n.stop()}}),n,null,[[0,14]])})))()},globalLogout:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o={withCredentials:!0,crossDomain:!0},t&&(o.headers={Authorization:"Bearer "+t}),n.next=5,f.a.get("".concat("https://auth.acc.effect.ai","/logout"),o);case 5:return e.user=null,n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(0),console.error(n.t0),n.abrupt("return",!1);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})))()},isAdmin:function(t){return!!t&&(t.roles.includes("admin")||t.app.roles.includes("admin"))}}},y=n(25),component=Object(y.a)(k,(function(){var t=this,e=t._self._c;return e("section",{staticClass:"section"},[e("div",{staticClass:"container"},[e("h1",{staticClass:"title"},[t._v("\n      Qualification migration\n    ")]),t._v(" "),e("h2",{staticClass:"subtitle"},[t._v("\n      Migrate your qualifications from the old Effect Force to the new Effect Network Platform\n    ")]),t._v(" "),e("p",[t._v("\n      With great pleasure we would like to announce the migration tool is live!\n      With the release of this tool, it also means the announcement that we will be sunsetting the old Effect Force on the 1st of September.\n      In order to keep your earned qualifications, please migrate them before this date.\n      After this date, qualifications cannot be migrated, but it's not a huge deal, as you'll be able to re-take the qualifiers.\n    ")]),t._v(" "),e("br"),t._v(" "),e("p",[t._v("By connecting your old Effect Force account, you can migrate over your old qualifications to this new platform.")]),t._v(" "),e("hr"),t._v(" "),t.migrationNeeded||t.succesMessage?e("div",[t.user?e("div",{staticClass:"container"},[t._m(0),t._v(" "),e("div",{staticClass:"level"},[e("div",{staticClass:"level-item"},[e("div",{},[e("p",[t._v("Old Effect Force Account:")]),t._v(" "),e("hr"),t._v(" "),e("h2",{staticClass:"title is-4"},[t._v("\n                "+t._s(t.user.email)+"\n              ")]),t._v(" "),e("br"),t._v(" "),e("h4",{staticClass:"subtitle is-5"},[t._v("\n                "+t._s(t.user.name)+"\n              ")])])]),t._v(" "),e("div",{staticClass:"level-item",staticStyle:{"max-width":"10px"}},[e("font-awesome-icon",{staticClass:"fa-2xl",attrs:{icon:"fa-solid fa-arrow-right-long"}})],1),t._v(" "),e("div",{staticClass:"level-item"},[e("div",[e("p",[t._v("New Effect Force Account:")]),t._v(" "),e("hr"),t._v(" "),e("h2",{staticClass:"title is-4"},[t._v("\n                "+t._s(t.$auth.user.accountName.slice(0,5))+"..."+t._s(t.$auth.user.accountName.slice(t.$auth.user.accountName.length-5,t.$auth.user.accountName.length))+"@"+t._s(t.$auth.user.blockchain)+"\n              ")]),t._v(" "),e("br"),t._v(" "),e("h4",{staticClass:"subtitle is-5"},[t._v("\n                vAccountID: "),e("strong",[t._v(t._s(t.$auth.user.vAccountRows[0].id))])])])])]),t._v(" "),e("div",{staticClass:"container"},[e("div",{staticClass:"buttons is-centered"},[e("button",{staticClass:"button has-text-danger",attrs:{disabled:t.loading},on:{click:function(e){return e.preventDefault(),t.globalLogout(t.user.token)}}},[t._v("\n              Switch old account\n            ")]),t._v(" "),e("button",{staticClass:"button is-primary",class:{"is-loading":t.loading},attrs:{disabled:t.loading},on:{click:function(e){return t.migrate(t.user.token)}}},[t._v("\n              Migrate\n            ")])])])]):t.ssoToken?e("h3",[t._v("\n        Logging in..\n      ")]):e("h3",[e("button",{staticClass:"button is-primary",on:{click:t.login}},[t._v("\n          Connect to old Force account\n        ")])])]):e("div",[e("h1",{staticClass:"title is-5"},[t._v("\n        You have already migrated an old account to this account.\n      ")])])]),t._v(" "),t.successMessage?e("success-modal",{attrs:{message:t.successMessage,title:t.successTitle}}):t._e()],1)}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"notification is-warning"},[e("b",[t._v("ATTENTION!")]),t._v(" You can only migrate your old qualifications "),e("strong",[t._v("ONCE")]),t._v(", so make sure to do it with your correct account.\n        ")])}],!1,null,null,null);e.default=component.exports}}]);