(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1512:function(t,e,n){"use strict";n.r(e);var r=n(3),o=(n(31),n(23),n(96),n(46),n(136),n(111),n(121),n(214)),c=n.n(o),l=n(1363),f=function(t){return new Promise((function(e,n){l.verify(t,"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArLpKfclXhvd2r0rlihq2\nGTIWxprGoRHm0aVIRlQCt39XE8/QeZBdv35fE/Q5tgW0aTOw6kJVK41I792vJ/P3\nK6KLQCxFoKmPF0BUirNnZ1QVGV4/kxYIGQfMpZmmyMj+p8MKdyszQSsWsmOjX0uU\npND6Sul4Dlv+lsiK8im8utQ90sZtnRC4KF6SzKkZjKN4Zzymepz6Ei/4dWef4TzH\nAs+N0Kb2LE2b0l5QZDOP9GOmLNqm+sfBiV2IvkcgL4DDuqhPvUif2r26HON+XH64\nWXCjUZML8AHOgAgu8p+8AZQFg8y6KT07F14JXT7FFlvye6FgTj8oL/ZtwN4Pbo7f\nGwIDAQAB\n-----END PUBLIC KEY-----",{algorithms:["RS256"]},(function(t,r){return t?n(t):e(r)}))}))},h={name:"Migrate",middleware:["auth"],data:function(){return{user:null,ssoToken:this.$route.query.ssoToken}},created:function(){this.ssoToken?this.getToken(this.ssoToken):this.login()},methods:{login:function(){var t=window.location.origin+"/migrate";window.location="".concat("https://auth.effect.ai","?redirect=").concat(t)},migrate:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.a.post("".concat("https://worker.effect.ai","/user/migrate-qualifications"),e.$auth.user.vAccountRows[0].id,{headers:{Authorization:"Bearer "+t}});case 2:r=n.sent,console.log(r.data);case 4:case"end":return n.stop()}}),n)})))()},getToken:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("".concat("https://auth.effect.ai","/verify"),t),n.next=4,c.a.post("".concat("https://auth.effect.ai","/verify"),{ssoToken:t},{headers:{Auth:"NO-AUTH"}});case 4:return l=n.sent,r=l.data.token,n.next=8,f(r);case 8:(o=n.sent).token=r,e.user=o,console.log("logged in",o),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),console.error(n.t0);case 17:return e.ssoToken=null,delete(h=Object.assign({},e.$route.query)).ssoToken,e.$router.replace({query:h}),n.abrupt("return",o);case 22:case"end":return n.stop()}}),n,null,[[0,14]])})))()},globalLogout:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r={withCredentials:!0,crossDomain:!0},t&&(r.headers={Authorization:"Bearer "+t}),n.next=5,c.a.get("".concat("https://auth.effect.ai","/logout"),r);case 5:return e.login(),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(0),console.error(n.t0),n.abrupt("return",!1);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})))()},isAdmin:function(t){return!!t&&(t.roles.includes("admin")||t.app.roles.includes("admin"))}}},v=n(22),component=Object(v.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[t.user?n("div",[n("h2",{staticClass:"title"},[t._v("\n        "+t._s(t.user.name)+"\n      ")]),t._v(" "),n("h4",{staticClass:"subtitle"},[t._v("\n        "+t._s(t.user.email)+"\n      ")]),t._v(" "),n("div",[n("button",{staticClass:"button is-primary",on:{click:function(e){return t.migrate(t.user.token)}}},[t._v("\n          Migrate\n        ")])]),t._v(" "),n("div",{staticClass:"mt-4"},[n("button",{staticClass:"button is-danger",on:{click:function(e){return t.globalLogout(t.user.token)}}},[t._v("\n          Logout\n        ")])])]):t.ssoToken?n("h3",[t._v("\n      Logging in..\n    ")]):n("h3",[t._v("\n      Redirecting to authorization server..\n    ")])])])}),[],!1,null,null,null);e.default=component.exports}}]);